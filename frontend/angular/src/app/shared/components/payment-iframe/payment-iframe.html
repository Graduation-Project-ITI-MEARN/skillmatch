<div
  class="flex flex-col w-137.5 h-[80vh] max-w-[95vw] bg-white rounded-2xl overflow-hidden border border-gray-100 shadow-2xl"
>
  <div class="p-4 border-b flex justify-between items-center bg-gray-50 shrink-0">
    <h3 class="font-bold text-gray-800 m-0">بوابة الدفع الآمنة</h3>
    <button
      (click)="close()"
      class="text-gray-400 hover:text-black border-none bg-transparent text-2xl cursor-pointer"
    >
      ✕
    </button>
  </div>

  <div class="grow w-full relative bg-gray-50">
    <iframe
      [src]="safeUrl"
      class="absolute inset-0 w-full h-full border-none"
      allow="payment"
    ></iframe>

    <!-- Payment Success Overlay -->
    <div
      *ngIf="paymentCompleted"
      class="absolute inset-0 bg-white/95 backdrop-blur-sm flex items-center justify-center z-10"
    >
      <div class="text-center">
        <div
          class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"
        >
          <svg
            class="w-10 h-10 text-green-600"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M5 13l4 4L19 7"
            ></path>
          </svg>
        </div>
        <h3 class="text-xl font-bold text-gray-900 mb-2">تم الدفع بنجاح!</h3>
        <p class="text-gray-600 mb-4">جاري معالجة طلبك...</p>
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"></div>
      </div>
    </div>
  </div>

  <div class="p-4 bg-indigo-50 border-t shrink-0">
    <button
      (click)="simulatePayment()"
      [disabled]="paymentCompleted"
      [class.opacity-50]="paymentCompleted"
      [class.cursor-not-allowed]="paymentCompleted"
      class="w-full bg-gray-900 text-white py-4 rounded-xl font-bold hover:bg-gray-950 shadow-lg transition-all active:scale-95 cursor-pointer border-none disabled:hover:bg-gray-900"
    >
      {{ paymentCompleted ? 'جاري المعالجة...' : 'لقد أتممت عملية الدفع بنجاح' }}
    </button>
  </div>
</div>
