<div class="overview-container">
  <!-- Main Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Left Section -->
    <div class="lg:col-span-2 space-y-6">
      <!-- Active Job Postings Section -->
      <div class="section-card">
        <div class="section-header">
          <h2 class="section-title">{{ 'DASHBOARD.OVERVIEW.MY_JOB_POSTINGS' | translate }}</h2>

          <!-- Search & Filter -->
          <div class="search-filter-container">
            <!-- Search Input -->
            <div class="search-wrapper">
              <lucide-icon [img]="icons.Search" class="search-icon"></lucide-icon>
              <input
                type="text"
                [(ngModel)]="searchQuery"
                (keyup.enter)="onSearch()"
                (blur)="onSearchBlur()"
                [placeholder]="'DASHBOARD.COMMON.SEARCH' | translate"
                class="search-input"
              />
            </div>

            <!-- Filter Button -->
            <button class="filter-btn" (click)="toggleFilter()">
              <lucide-icon [img]="icons.Filter" class="w-4 h-4"></lucide-icon>
              <span class="hidden md:inline">{{ 'DASHBOARD.COMMON.FILTER' | translate }}</span>
              @if(activeFiltersCount > 0) {
              <span class="filter-badge">{{ activeFiltersCount }}</span>
              }
            </button>
          </div>
        </div>

        <!-- Loading State -->
        @if(isLoadingChallenges) {
        <div class="space-y-4">
          @for(i of [1,2,3]; track i) {
          <div class="challenge-card-skeleton"></div>
          }
        </div>
        }

        <!-- Challenges List -->
        @else if(challenges.length > 0) {
        <div class="space-y-4">
          @for(challenge of challenges; track challenge.id) {
          <div class="challenge-card">
            <!-- Header -->
            <div class="challenge-header">
              <div class="flex-1">
                <div class="challenge-badges">
                  <span class="category-badge">{{ challenge.category }}</span>
                  <span class="status-badge" [ngClass]="getStatusClass(challenge.status)">
                    {{ challenge.status }}
                  </span>
                </div>
                <h3 class="challenge-title">{{ challenge.title }}</h3>
                <p class="challenge-meta">
                  <lucide-icon [img]="icons.Clock" class="w-4 h-4"></lucide-icon>
                  {{ challenge.daysRemaining }}
                  {{ 'DASHBOARD.OVERVIEW.DAYS_REMAINING' | translate }}
                </p>
              </div>

              <div class="challenge-budget">
                <p class="budget-amount">\${{ challenge.budget }}</p>
                <p class="budget-label">{{ 'DASHBOARD.OVERVIEW.OFFER' | translate }}</p>
              </div>
            </div>

            <!-- Stats -->
            <div class="challenge-stats">
              <div class="stat-item">
                <lucide-icon [img]="icons.Users" class="stat-icon"></lucide-icon>
                <div>
                  <p class="stat-value">{{ challenge.applications }}</p>
                  <p class="stat-label">{{ 'DASHBOARD.OVERVIEW.APPLICATIONS' | translate }}</p>
                </div>
              </div>

              <div class="stat-item">
                <lucide-icon [img]="icons.TrendingUp" class="stat-icon"></lucide-icon>
                <div>
                  <p class="stat-value">{{ challenge.topScore }}</p>
                  <p class="stat-label">{{ 'DASHBOARD.OVERVIEW.TOP_SCORE' | translate }}</p>
                </div>
              </div>

              <div class="stat-item">
                <lucide-icon [img]="icons.Target" class="stat-icon"></lucide-icon>
                <div>
                  <p class="stat-value">{{ challenge.qualified }}</p>
                  <p class="stat-label">{{ 'DASHBOARD.OVERVIEW.QUALIFIED' | translate }}</p>
                </div>
              </div>
            </div>

            <!-- Actions -->
            <div class="challenge-actions">
              <button class="action-btn primary">
                <lucide-icon [img]="icons.Eye" class="w-4 h-4"></lucide-icon>
                {{ 'DASHBOARD.OVERVIEW.VIEW_APPLICATIONS' | translate }}
              </button>
              <button class="action-btn secondary">
                {{ 'DASHBOARD.OVERVIEW.EDIT_JOB' | translate }}
              </button>
            </div>
          </div>
          }
        </div>
        }

        <!-- Empty State -->
        @else {
        <div class="empty-state">
          <lucide-icon [img]="icons.FileText" class="w-12 h-12 text-gray-300"></lucide-icon>
          <p class="empty-text">{{ 'DASHBOARD.OVERVIEW.NO_CHALLENGES' | translate }}</p>
        </div>
        }

        <!-- Create New Button -->
        <button class="create-new-btn">
          <span class="text-2xl">+</span>
          {{ 'DASHBOARD.OVERVIEW.CREATE_NEW_POSTING' | translate }}
        </button>
      </div>
    </div>

    <!-- Right Sidebar -->
    <div class="space-y-6">
      <!-- Hiring Insights Widget -->
      <div class="widget-card">
        <div class="widget-header">
          <lucide-icon [img]="icons.TrendingUp" class="w-5 h-5 text-primary"></lucide-icon>
          <h3 class="widget-title">{{ 'DASHBOARD.OVERVIEW.HIRING_INSIGHTS' | translate }}</h3>
        </div>

        <div class="insight-content">
          <p class="insight-text">
            {{
              'DASHBOARD.OVERVIEW.HIGH_QUALITY_CANDIDATES'
                | translate : { count: hiringInsights.highQualityCandidates }
            }}
          </p>

          <div class="insight-meta">
            <span class="text-sm text-gray-600">
              {{ 'DASHBOARD.OVERVIEW.AVG_EVALUATION_TIME' | translate }}:
            </span>

            @if(hiringInsights.isPowered) {
            <span class="powered-badge">{{ 'DASHBOARD.OVERVIEW.AI_POWERED' | translate }}</span>
            }
          </div>

          <button class="insight-btn bg-primary-gradient">
            {{ 'DASHBOARD.OVERVIEW.VIEW_RECOMMENDATIONS' | translate }}
          </button>
        </div>
      </div>

      <!-- Recent Activity Widget -->
      <div class="widget-card">
        <h3 class="widget-title mb-4">{{ 'DASHBOARD.OVERVIEW.RECENT_ACTIVITY' | translate }}</h3>

        @if(isLoadingActivity) {
        <div class="space-y-3">
          @for(i of [1,2,3,4,5]; track i) {
          <div class="activity-skeleton"></div>
          }
        </div>
        } @else if(activities.length > 0) {
        <div class="activity-list">
          @for(activity of activities; track activity.id) {
          <div class="activity-item">
            <div class="activity-icon" [ngClass]="getActivityColor(activity.type)">
              <lucide-icon [img]="getActivityIcon(activity.type)" class="w-4 h-4"></lucide-icon>
            </div>

            <div class="activity-content">
              <p class="activity-title">
                @if(activity.type === 'application') {
                {{ 'DASHBOARD.OVERVIEW.NEW_APPLICATION' | translate }}
                } @else if(activity.type === 'shortlist') {
                {{ 'DASHBOARD.OVERVIEW.CANDIDATE_SHORTLISTED' | translate }}
                } @else if(activity.type === 'completed') {
                {{ 'DASHBOARD.OVERVIEW.CHALLENGE_COMPLETED' | translate }}
                } @else {
                {{ 'DASHBOARD.OVERVIEW.JOB_CLOSED' | translate }}
                }
              </p>
              <p class="activity-subtitle">{{ activity.challengeTitle }}</p>
              @if(activity.candidateName) {
              <p class="activity-candidate">{{ activity.candidateName }}</p>
              }
            </div>

            <span class="activity-time">{{ activity.timestamp }}</span>
          </div>
          }
        </div>
        } @else {
        <div class="empty-state-small">
          <lucide-icon [img]="icons.Calendar" class="w-8 h-8 text-gray-300"></lucide-icon>
          <p class="text-sm text-gray-500">{{ 'DASHBOARD.OVERVIEW.NO_ACTIVITY' | translate }}</p>
        </div>
        }
      </div>
    </div>
  </div>

  <!-- Filter Modal -->
  @if(isFilterOpen) {
  <div class="filter-overlay" (click)="closeFilter()">
    <div class="filter-modal" (click)="$event.stopPropagation()">
      <!-- Header -->
      <div class="filter-modal-header">
        <h3 class="filter-modal-title">{{ 'DASHBOARD.COMMON.FILTERS' | translate }}</h3>
        <button class="close-btn" (click)="closeFilter()">
          <lucide-icon [img]="icons.X" class="w-5 h-5"></lucide-icon>
        </button>
      </div>

      <!-- Body -->
      <div class="filter-modal-body">
        <!-- Job Type -->
        <div class="filter-section">
          <h4 class="filter-section-title">
            {{ 'DASHBOARD.FILTERS.JOB_TYPE' | translate }}
          </h4>
          <div class="filter-options">
            @for (jobType of filterOptions.jobTypes; track jobType.value) {
            <label class="filter-option">
              <input
                type="checkbox"
                [checked]="selectedJobTypes.includes(jobType.value)"
                (change)="toggleJobType(jobType.value)"
                class="filter-checkbox"
              />
              <span class="filter-label">
                {{ jobType.label | translate }}
              </span>
              <span class="filter-count">{{ jobType.count }}</span>
            </label>
            }
          </div>
        </div>

        <!-- Status -->
        <div class="filter-section">
          <h4 class="filter-section-title">
            {{ 'DASHBOARD.FILTERS.STATUS' | translate }}
          </h4>
          <div class="filter-options">
            @for (status of filterOptions.statuses; track status.value) {
            <label class="filter-option">
              <input
                type="checkbox"
                [checked]="selectedStatuses.includes(status.value)"
                (change)="toggleStatus(status.value)"
                class="filter-checkbox"
              />
              <span class="filter-label">
                {{ status.label | translate }}
              </span>
              <span class="filter-count">{{ status.count }}</span>
            </label>
            }
          </div>
        </div>

        <!-- Budget Range -->
        <div class="filter-section">
          <h4 class="filter-section-title">
            {{ 'DASHBOARD.FILTERS.BUDGET_RANGE' | translate }}
          </h4>
          <div class="filter-options">
            @for (budget of filterOptions.budgets; track budget.value) {
            <label class="filter-option">
              <input
                type="checkbox"
                [checked]="selectedBudgets.includes(budget.value)"
                (change)="toggleBudget(budget.value)"
                class="filter-checkbox"
              />
              <span class="filter-label">
                {{ budget.label | translate }}
              </span>
              <span class="filter-count">{{ budget.count }}</span>
            </label>
            }
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="filter-modal-footer">
        <button class="clear-btn" (click)="clearAllFilters()">
          {{ 'DASHBOARD.COMMON.CLEAR_ALL' | translate }}
        </button>
        <div class="filter-actions">
          <button class="cancel-btn" (click)="closeFilter()">
            {{ 'DASHBOARD.COMMON.CANCEL' | translate }}
          </button>
          <button class="apply-btn bg-primary-gradient" (click)="applyFiltersAndClose()">
            {{ 'DASHBOARD.COMMON.APPLY_FILTERS' | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
  }
</div>
