import{a as De}from"./chunk-3JJQSS4P.js";import{a as ve}from"./chunk-SX7D23K2.js";import{a as oe,b as fe,c as U,d as xe}from"./chunk-BTBIWTRM.js";import"./chunk-YGBCOKBM.js";import"./chunk-2YIDOPGG.js";import"./chunk-2DHYFB3B.js";import{c as ge,e as ue,i as _e,x as Ce}from"./chunk-CYRR275F.js";import{h as re}from"./chunk-LDRJV2AZ.js";import{B as ce,G as de,N as pe,R as w,S as V,U as M,ea as me,lb as B,mb as P,w as le,x as se}from"./chunk-XQKT32VU.js";import{c as S,e as E}from"./chunk-GEE437AJ.js";import"./chunk-EZWRTDAZ.js";import"./chunk-5FFKEXUF.js";import{j as ae,s as b}from"./chunk-OAPWU2O3.js";import{Ab as _,Ac as c,Bc as O,Cb as q,Db as H,Eb as L,Fb as p,Gb as r,Hb as a,Ib as f,Ic as $,Jb as z,Kb as Z,Pb as T,Sa as h,Ub as I,Wa as n,Wb as d,_ as C,da as y,ea as A,gb as Y,ic as o,jc as v,kb as D,kc as m,lc as K,oc as Q,pa as R,pc as ee,qc as te,rc as ie,sc as ne,vc as N,wc as G,zb as u,zc as s}from"./chunk-565OUHKP.js";function ye(i,t){if(i&1&&(r(0,"div",1)(1,"p",4),o(2),s(3,"translate"),a(),r(4,"p",5),o(5),a()()),i&2){let e=d();n(2),m(" ",c(3,2,"DASHBOARD.ADMIN.USERS.NATIONAL_ID_NUMBER")," "),n(3),v(e.data.nationalId)}}function Ae(i,t){if(i&1&&(r(0,"div",1)(1,"p",4),o(2),s(3,"translate"),a(),r(4,"p",5),o(5),a()()),i&2){let e=d();n(2),m(" ",c(3,2,"DASHBOARD.ADMIN.USERS.TAX_ID_NUMBER")," "),n(3),v(e.data.taxIdCard)}}function Re(i,t){if(i&1&&(r(0,"a",9),f(1,"img",10),r(2,"div",11),f(3,"lucide-icon",12),a()(),r(4,"div",13)(5,"span"),o(6),s(7,"translate"),a(),f(8,"lucide-icon",14),a()),i&2){let e=d(2);p("href",e.data.verificationDocument,h),n(),p("src",e.data.verificationDocument,h),n(2),p("img",e.icons.Eye),n(3),v(c(7,5,"DASHBOARD.ADMIN.USERS.DOCUMENT")),n(2),p("img",e.icons.Image)}}function Ie(i,t){if(i&1&&(r(0,"div",15),f(1,"lucide-icon",16),r(2,"p",17),o(3),s(4,"translate"),a()(),r(5,"div",18)(6,"a",19),f(7,"lucide-icon",20),r(8,"span"),o(9),s(10,"translate"),a()(),f(11,"lucide-icon",21),a()),i&2){let e=d(2);n(),p("img",e.icons.FileText),n(2),m(" ",c(4,6,"DASHBOARD.ADMIN.USERS.PDF_DOCUMENT")," "),n(3),p("href",e.data.verificationDocument,h),n(),p("img",e.icons.ExternalLink),n(2),v(c(10,8,"DASHBOARD.ADMIN.USERS.OPEN_PDF")),n(2),p("img",e.icons.FileText)}}function be(i,t){if(i&1&&(r(0,"div",15),f(1,"lucide-icon",16),r(2,"p",17),o(3),s(4,"translate"),a()(),r(5,"div",18)(6,"a",19),f(7,"lucide-icon",20),r(8,"span"),o(9),s(10,"translate"),a()(),f(11,"lucide-icon",22),a()),i&2){let e=d(2);n(),p("img",e.icons.ExternalLink),n(2),m(" ",c(4,6,"DASHBOARD.ADMIN.USERS.OTHER_DOCUMENT_TYPE")," "),n(3),p("href",e.data.verificationDocument,h),n(),p("img",e.icons.ExternalLink),n(2),v(c(10,8,"DASHBOARD.ADMIN.USERS.VIEW_DOCUMENT")),n(2),p("img",e.icons.FileText)}}function Ue(i,t){if(i&1&&(r(0,"div",2)(1,"p",6),o(2),s(3,"translate"),a(),r(4,"div",7)(5,"div",8),u(6,Re,9,7)(7,Ie,12,10)(8,be,12,10),a()()()),i&2){let e=d();n(2),m(" ",c(3,2,"DASHBOARD.ADMIN.USERS.VERIFICATION_DOCUMENT")," "),n(4),_(e.isImageUrl(e.data.verificationDocument)?6:e.isPdfUrl(e.data.verificationDocument)?7:8)}}function he(i,t){i&1&&(r(0,"div",3),o(1),s(2,"translate"),a()),i&2&&(n(),m(" ",c(2,1,"DASHBOARD.ADMIN.USERS.NO_DOCUMENTS_UPLOADED")," "))}var F=class i{constructor(){this.data=C(U);this.icons={ExternalLink:w,Image:me,FileText:M,Eye:V}}isImageUrl(t){return/\.(jpeg|jpg|png|gif|webp)$/i.test(t)}isPdfUrl(t){return/\.pdf$/i.test(t)}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-view-verification-details"]],decls:5,vars:3,consts:[[1,"space-y-4","p-2"],[1,"bg-gray-50","p-3","rounded-md","border","border-gray-200"],[1,"space-y-4"],[1,"text-sm","text-gray-500"],[1,"text-xs","font-medium","text-gray-500"],[1,"text-gray-800","font-semibold"],[1,"text-sm","font-medium","text-gray-700"],[1,"grid","grid-cols-1","gap-4"],[1,"bg-white","border","border-gray-200","rounded-lg","overflow-hidden","shadow-sm"],["target","_blank",1,"block","group","relative",3,"href"],["alt","Verification Document",1,"w-full","h-48","object-cover","group-hover:opacity-75","transition-opacity",3,"src"],[1,"absolute","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-50","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"w-8","h-8","text-white",3,"img"],[1,"p-3","text-sm","text-gray-700","flex","justify-between","items-center"],[1,"w-4","h-4","text-blue-500",3,"img"],[1,"w-full","h-48","bg-gray-100","flex","flex-col","items-center","justify-center","p-4"],[1,"w-12","h-12","text-gray-400","mb-2",3,"img"],[1,"text-sm","text-gray-600","text-center"],[1,"p-3","flex","justify-between","items-center"],["target","_blank",1,"flex","items-center","gap-2","text-primary-600","hover:text-primary-800","transition-colors","text-sm",3,"href"],[1,"w-4","h-4",3,"img"],[1,"w-4","h-4","text-red-500",3,"img"],[1,"w-4","h-4","text-gray-500",3,"img"]],template:function(e,l){e&1&&(r(0,"div",0),u(1,ye,6,4,"div",1),u(2,Ae,6,4,"div",1),u(3,Ue,9,4,"div",2)(4,he,3,3,"div",3),a()),e&2&&(n(),_(l.data.nationalId?1:-1),n(),_(l.data.taxIdCard?2:-1),n(),_(l.data.verificationDocument?3:4))},dependencies:[b,E,P,B,S],encapsulation:2})}};var Te=i=>({name:i}),k=class i{constructor(){this.data=C(U)}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-verify-confirmation"]],decls:7,vars:9,consts:[[1,"p-2"],[1,"text-gray-700"],[1,"text-sm","text-gray-500","mt-2"]],template:function(e,l){e&1&&(z(0,"div",0)(1,"p",1),o(2),s(3,"translate"),Z(),z(4,"p",2),o(5),s(6,"translate"),Z()()),e&2&&(n(2),m(" ",O(3,2,"DASHBOARD.ADMIN.USERS.VERIFY_CONFIRMATION_MESSAGE",N(7,Te,l.data.userName))," "),n(3),m(" ",c(6,5,"DASHBOARD.ADMIN.USERS.VERIFY_CONFIRMATION_SUBMESSAGE")," "))},dependencies:[E,S],encapsulation:2})}};var Ne=i=>({name:i}),j=class i{constructor(){this.data=C(U);this.dialogRef=C(oe);this.rejectionReason=R("")}get rejectionResult(){return this.rejectionReason()}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-reject-confirmation"]],decls:14,vars:20,consts:[[1,"space-y-4","p-2"],[1,"text-gray-700"],[1,"space-y-2"],["for","rejectionReason",1,"block","text-sm","font-medium","text-gray-700"],["id","rejectionReason","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2",3,"ngModelChange","ngModel","placeholder"],[1,"text-sm","text-gray-500","mt-2"]],template:function(e,l){e&1&&(r(0,"div",0)(1,"p",1),o(2),s(3,"translate"),a(),r(4,"div",2)(5,"label",3),o(6),s(7,"translate"),s(8,"translate"),a(),r(9,"textarea",4),s(10,"translate"),ie("ngModelChange",function(g){return te(l.rejectionReason,g)||(l.rejectionReason=g),g}),a()(),r(11,"p",5),o(12),s(13,"translate"),a()()),e&2&&(n(2),m(" ",O(3,7,"DASHBOARD.ADMIN.USERS.REJECT_CONFIRMATION_MESSAGE",N(18,Ne,l.data.userName))," "),n(4),K(" ",c(7,10,"DASHBOARD.ADMIN.USERS.REJECTION_REASON_LABEL")," (",c(8,12,"DASHBOARD.GENERAL.OPTIONAL"),") "),n(3),p("placeholder",ne(c(10,14,"DASHBOARD.ADMIN.USERS.REJECTION_REASON_PLACEHOLDER"))),ee("ngModel",l.rejectionReason),n(3),m(" ",c(13,16,"DASHBOARD.ADMIN.USERS.REJECT_CONFIRMATION_SUBMESSAGE")," "))},dependencies:[b,E,Ce,ge,ue,_e,S],encapsulation:2})}};var Oe=(i,t)=>({"bg-gray-900 text-white":i,"bg-white border border-gray-200 text-gray-700 hover:bg-gray-50":t}),we=(i,t)=>({"bg-green-100 text-green-700":i,"bg-yellow-100 text-yellow-700":t}),Ve=(i,t)=>t._id;function Me(i,t){if(i&1){let e=T();r(0,"button",9),I("click",function(){let x=y(e).$implicit,g=d();return A(g.setTab(x))}),o(1),s(2,"translate"),a()}if(i&2){let e=t.$implicit,l=d();p("ngClass",G(4,Oe,l.currentTab()===e,l.currentTab()!==e)),n(),m(" ",c(2,2,e)," ")}}function Be(i,t){i&1&&(r(0,"div",7),o(1),s(2,"translate"),a()),i&2&&(n(),m(" ",c(2,1,"DASHBOARD.GENERAL.LOADING")," "))}function Pe(i,t){i&1&&(r(0,"div",10)(1,"p"),o(2),s(3,"translate"),a()()),i&2&&(n(2),v(c(3,1,"DASHBOARD.ADMIN.USERS.NO_USERS")))}function Fe(i,t){if(i&1&&(f(0,"lucide-icon",21),r(1,"span"),o(2,"Tax Card: Requires Review"),a()),i&2){let e=d(5);p("img",e.icons.CreditCard)}}function ke(i,t){if(i&1&&(f(0,"lucide-icon",21),r(1,"span"),o(2,"ID: Requires Review"),a()),i&2){let e=d(5);p("img",e.icons.FileText)}}function je(i,t){if(i&1&&(r(0,"div",19),u(1,Fe,3,1)(2,ke,3,1),a()),i&2){let e=d().$implicit;n(),_(e.type==="company"?1:2)}}function He(i,t){if(i&1){let e=T();r(0,"button",24),I("click",function(){y(e);let x=d(2).$implicit,g=d(3);return A(g.onVerify(x))}),f(1,"lucide-icon",23),o(2),s(3,"translate"),a(),r(4,"button",25),I("click",function(){y(e);let x=d(2).$implicit,g=d(3);return A(g.onReject(x))}),f(5,"lucide-icon",23),o(6),s(7,"translate"),a()}if(i&2){let e=d(5);n(),p("img",e.icons.CheckCircle),n(),m(" ",c(3,4,"DASHBOARD.ADMIN.USERS.VERIFY")," "),n(3),p("img",e.icons.XCircle),n(),m(" ",c(7,6,"DASHBOARD.ADMIN.USERS.REJECT")," ")}}function Le(i,t){if(i&1){let e=T();r(0,"div",20)(1,"button",22),I("click",function(){y(e);let x=d().$implicit,g=d(3);return A(g.onView(x))}),f(2,"lucide-icon",23),o(3),s(4,"translate"),s(5,"translate"),a(),u(6,He,8,8),a()}if(i&2){let e=d().$implicit,l=d(3);n(2),p("img",l.icons.Eye),n(),m(" ",e.type==="company"?c(4,3,"DASHBOARD.ADMIN.USERS.VIEW_TAX"):c(5,5,"DASHBOARD.ADMIN.USERS.VIEW_ID")," "),n(3),_(e.isVerified?-1:6)}}function ze(i,t){if(i&1&&(r(0,"ui-card",11)(1,"div",12)(2,"div",13),o(3),a(),r(4,"div",14)(5,"div",15)(6,"h3",16),o(7),a(),r(8,"span",17),o(9),a(),r(10,"span",18),o(11),a()(),u(12,je,3,1,"div",19),a(),u(13,Le,7,7,"div",20),a()()),i&2){let e=t.$implicit,l=d(3);n(3),m(" ",l.getInitials(e.name)," "),n(4),v(e.name),n(2),m(" ",e.type||e.role," "),n(),p("ngClass",G(7,we,e.isVerified,!e.isVerified)),n(),m(" ",e.isVerified?"Verified":"Pending"," "),n(),_(e.isVerified?-1:12),n(),_(e.verificationDocument?13:-1)}}function Ze(i,t){if(i&1&&H(0,ze,14,10,"ui-card",11,Ve),i&2){let e=d(2);L(e.paginatedUsers())}}function Ge(i,t){if(i&1&&u(0,Pe,4,3,"div",10)(1,Ze,2,0),i&2){let e=d();_(e.allUsers().length===0?0:1)}}function $e(i,t){if(i&1){let e=T();r(0,"div",8)(1,"span",26),o(2),s(3,"translate"),s(4,"translate"),a(),r(5,"div",27)(6,"button",28),I("click",function(){y(e);let x=d();return A(x.prevPage())}),f(7,"lucide-icon",23),o(8),s(9,"translate"),a(),r(10,"button",28),I("click",function(){y(e);let x=d();return A(x.nextPage())}),o(11),s(12,"translate"),f(13,"lucide-icon",23),a()()()}if(i&2){let e=d();n(2),Q(" ",c(3,11,"DASHBOARD.GENERAL.SHOWING")," ",(e.currentPage()-1)*e.itemsPerPage+1," - ",e.currentPage()*e.itemsPerPage>e.allUsers().length?e.allUsers().length:e.currentPage()*e.itemsPerPage," ",c(4,13,"DASHBOARD.GENERAL.OF")," ",e.allUsers().length," "),n(4),p("disabled",e.currentPage()===1),n(),p("img",e.icons.ChevronLeft),n(),m(" ",c(9,15,"DASHBOARD.GENERAL.PREVIOUS")," "),n(2),p("disabled",e.currentPage()>=e.totalPages()),n(),m(" ",c(12,17,"DASHBOARD.GENERAL.NEXT")," "),n(2),p("img",e.icons.ChevronRight)}}var Se=class i{constructor(){this.userService=C(De);this.dialogService=C(xe);this.vcr=C(Y);this.toastService=C(re);this.allUsers=R([]);this.loading=R(!1);this.currentPage=R(1);this.itemsPerPage=6;this.paginatedUsers=$(()=>{let t=(this.currentPage()-1)*this.itemsPerPage,e=t+this.itemsPerPage;return this.allUsers().slice(t,e)});this.totalPages=$(()=>Math.ceil(this.allUsers().length/this.itemsPerPage));this.currentTab=R("All Users");this.tabs=["All Users","Candidates","Companies","Challengers"];this.icons={Eye:V,CheckCircle:ce,XCircle:de,CreditCard:pe,FileText:M,ChevronLeft:le,ChevronRight:se,ExternalLink:w}}ngOnInit(){this.loadUsers()}loadUsers(){this.loading.set(!0);let t={sort:"-createdAt",limit:1e3},e=this.currentTab();e==="All Users"?t.role="user":e==="Candidates"?(t.role="user",t.type="candidate"):e==="Companies"?(t.role="user",t.type="company"):e==="Challengers"&&(t.role="user",t.type="challenger"),this.userService.getAllUsers(t).subscribe({next:l=>{this.allUsers.set(l.data||[]),this.currentPage.set(1),this.loading.set(!1)},error:l=>{this.loading.set(!1),this.toastService.error("Error",l.message||"Failed to load users.")}}),console.log(this.allUsers())}setTab(t){this.currentTab.set(t),this.loadUsers()}nextPage(){this.currentPage()<this.totalPages()&&(this.currentPage.update(t=>t+1),this.scrollToTop())}prevPage(){this.currentPage()>1&&(this.currentPage.update(t=>t+-1),this.scrollToTop())}scrollToTop(){let t=document.getElementById("user-list-top");t&&t.scrollIntoView({behavior:"smooth"})}onView(t){let e={userName:t.name||t.email,userType:t.type,nationalId:t.nationalId,taxIdCard:t.taxIdCard,verificationDocument:t.verificationDocument||""};console.log(e),this.dialogService.create({zContent:F,zTitle:t.type==="company"?"DASHBOARD.ADMIN.USERS.VIEW_TAX_DETAILS":"DASHBOARD.ADMIN.USERS.VIEW_ID_DETAILS",zData:e,zHideFooter:!0,zViewContainerRef:this.vcr})}onVerify(t){let e=this.dialogService.create({zContent:k,zTitle:"DASHBOARD.ADMIN.USERS.VERIFY_USER_TITLE",zData:{userName:t.name||t.email},zOkText:"DASHBOARD.ADMIN.USERS.VERIFY_BUTTON",zOkIcon:"checkCircle",zOkDestructive:!1,zViewContainerRef:this.vcr,zOnOk:()=>(this.userService.updateUserVerificationStatus(t._id,{status:"verified"}).subscribe({next:()=>{this.toastService.success("Success",`${t.name} has been verified.`),this.loadUsers(),e.close()},error:l=>{this.toastService.error("Error",l.message||"Failed to verify user."),e.close()}}),!1),zOnCancel:()=>{e.close()}})}onReject(t){let e=this.dialogService.create({zContent:j,zTitle:"DASHBOARD.ADMIN.USERS.REJECT_USER_TITLE",zData:{userName:t.name||t.email},zOkText:"DASHBOARD.ADMIN.USERS.REJECT_BUTTON",zOkIcon:"xCircle",zOkDestructive:!0,zViewContainerRef:this.vcr,zOnOk:l=>{let x=l.rejectionResult;return this.userService.updateUserVerificationStatus(t._id,{status:"rejected",reason:x}).subscribe({next:()=>{this.toastService.success("Success",`${t.name}'s verification was rejected.`),this.loadUsers(),e.close()},error:g=>{this.toastService.error("Error",g.message||"Failed to reject user verification."),e.close()}}),!1},zOnCancel:()=>{e.close()}})}getInitials(t){return t?t.split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase():"U"}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-admin-users"]],decls:16,vars:8,consts:[[1,"space-y-6","animate-in","fade-in","slide-in-from-bottom-4","duration-500"],["id","user-list-top",1,"flex","flex-col","md:flex-row","md:items-center","justify-between","gap-4"],[1,"text-2xl","font-bold","mb-2","text-gray-900"],[1,"text-gray-600"],[1,"flex","flex-wrap","gap-2"],[1,"px-4","py-2","rounded-md","transition-all","font-medium","text-sm",3,"ngClass"],[1,"space-y-3","min-h-100"],[1,"p-12","text-center","text-gray-500"],[1,"flex","items-center","justify-between","border-t","border-gray-200","pt-4","mt-4"],[1,"px-4","py-2","rounded-md","transition-all","font-medium","text-sm",3,"click","ngClass"],[1,"p-12","text-center","text-gray-500","bg-white","rounded-md","border","border-dashed","border-gray-200"],[1,"mb-4"],[1,"flex","flex-col","lg:flex-row","lg:items-center","gap-6"],[1,"w-12","h-12","rounded-full","bg-primary-gradient","flex","items-center","justify-center","text-white","font-bold","shrink-0"],[1,"flex-1"],[1,"flex","flex-wrap","items-center","gap-3","mb-1"],[1,"text-lg","font-semibold","text-gray-900"],[1,"px-3","py-1","bg-gray-100","rounded-full","text-xs","font-medium","text-gray-600","capitalize"],[1,"px-3","py-1","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"mt-2","flex","items-center","gap-2","text-xs","text-gray-600","animate-in","fade-in"],[1,"flex","gap-2","mt-4","lg:mt-0"],[1,"w-3","h-3",3,"img"],[1,"px-4","py-2","bg-gray-900","text-white","rounded-md","hover:bg-gray-800","transition-all","text-sm","flex","items-center","gap-2",3,"click"],[1,"w-4","h-4",3,"img"],[1,"px-4","py-2","bg-green-100","text-green-700","rounded-md","hover:bg-green-200","transition-all","text-sm","flex","items-center","gap-2",3,"click"],[1,"px-4","py-2","bg-red-100","text-red-700","rounded-md","hover:bg-red-200","transition-all","text-sm","flex","items-center","gap-2",3,"click"],[1,"text-sm","text-gray-500"],[1,"flex","gap-2"],[1,"flex","items-center","gap-1","px-3","py-1.5","rounded-md","border","border-gray-200","bg-white","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed","transition-all","text-sm","text-gray-600",3,"click","disabled"]],template:function(e,l){e&1&&(r(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),o(4),s(5,"translate"),a(),r(6,"p",3),o(7),s(8,"translate"),a()(),r(9,"div",4),H(10,Me,3,7,"button",5,q),a()(),r(12,"div",6),u(13,Be,3,3,"div",7)(14,Ge,2,1),a(),u(15,$e,14,19,"div",8),a()),e&2&&(n(4),m(" ",c(5,4,"DASHBOARD.ADMIN.USERS.TITLE")," "),n(3),v(c(8,6,"DASHBOARD.ADMIN.USERS.SUBTITLE")),n(3),L(l.tabs),n(3),_(l.loading()?13:14),n(2),_(!l.loading()&&l.allUsers().length>0?15:-1))},dependencies:[b,ae,P,B,E,ve,fe,S],encapsulation:2})}};export{Se as Users};
