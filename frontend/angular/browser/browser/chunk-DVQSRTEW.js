import{a as Ue,b as Xe,c as Je}from"./chunk-JJPBU5Z3.js";import{a as B,b as Ke}from"./chunk-YGBCOKBM.js";import{a as g,b as u,c as ce,d as Qe}from"./chunk-2YIDOPGG.js";import{l as $e,w as je,y as qe,z as Ge}from"./chunk-2DHYFB3B.js";import{a as ue}from"./chunk-CYRR275F.js";import{m as Be,s as We,w as He}from"./chunk-OAPWU2O3.js";import{$a as ke,Ab as le,Bb as A,C as re,Ca as Te,Cb as Fe,Db as V,Dc as De,Eb as I,Fb as y,Gb as p,Hb as m,Ib as E,Ic as c,Jb as q,Jc as K,Kb as G,Lc as C,Mc as s,Nc as L,Ob as Re,Oc as Le,Pb as Q,Pc as U,Qb as Ze,U as ie,Ub as v,Vb as Ae,Wa as d,Wb as b,Xb as Y,Yb as O,_,bc as Ye,ca as Ve,cc as P,da as T,dc as F,ea as k,ec as Oe,gb as Ee,ha as Ie,hc as h,ic as z,ja as Ne,jc as R,kb as D,kc as Ce,pa as x,pb as be,t as we,tc as de,vc as Pe,wb as M,ya as oe,zb as se}from"./chunk-565OUHKP.js";function N(r,e){return r.getFullYear()===e.getFullYear()&&r.getMonth()===e.getMonth()&&r.getDate()===e.getDate()}function Ct(r,e,t){return!!(e&&r<e||t&&r>t)}function et(r){let{year:e,month:t,mode:n,selectedDates:a,minDate:i,maxDate:o,disabled:l}=r,f=new Date,fe=new Date(e,t,1),he=new Date(e,t+1,0),ee=new Date(fe);ee.setDate(ee.getDate()-ee.getDay());let te=new Date(he);te.setDate(te.getDate()+(6-te.getDay()));let ze=[],ne=new Date(ee),H=null,$=null;for(n==="range"&&a.length>0&&(H=a[0],$=a.length>1?a[1]:null);ne<=te;){let w=new Date(ne),ft=w.getMonth()===t,ht=N(w,f),vt=l||Ct(w,i,o),j=!1,ve=!1,ye=!1,Se=!1;if(n==="single")j=a.length>0&&N(w,a[0]);else if(n==="multiple")j=a.some(ae=>N(w,ae));else if(n==="range"&&(H&&N(w,H)&&(ve=!0,j=!0),$&&N(w,$)&&(ye=!0,j=!0),H&&$&&!ve&&!ye)){let ae=w.getTime(),yt=H.getTime(),bt=$.getTime();Se=ae>yt&&ae<bt}ze.push({date:w,isCurrentMonth:ft,isToday:ht,isSelected:j,isDisabled:vt,isRangeStart:ve,isRangeEnd:ye,isInRange:Se}),ne.setDate(ne.getDate()+1)}return ze}function tt(r,e){return r?e==="single"?[r]:(e==="multiple"||e==="range")&&Array.isArray(r)?r:[]:[]}function Me(r){return`calendar-day-${r}`}function nt(r){let t=[r.date.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})];return r.isToday&&t.push("Today"),r.isSelected&&t.push("Selected"),r.isRangeStart&&t.push("Range start"),r.isRangeEnd&&t.push("Range end"),r.isInRange&&t.push("In range"),r.isCurrentMonth||t.push("Outside month"),r.isDisabled&&t.push("Disabled"),t.join(", ")}function S(r,e,t=1){let n=new Date(r,e,t);return n.setHours(12,0,0,0),n}function _e(r){return r?r instanceof Date?xe(r):Array.isArray(r)?r.map(e=>xe(e)):xe(r):null}function xe(r){if(r instanceof Date)return r;if(typeof r=="number"&&r.toString().length===8){let t=r.toString(),n=+t.slice(0,4),a=+t.slice(4,6)-1,i=+t.slice(6,8);return S(n,a,i)}if(typeof r=="string"&&/^\d{8}$/.test(r)){let t=+r.slice(0,4),n=+r.slice(4,6)-1,a=+r.slice(6,8);return S(t,n,a)}let e=new Date(r);return isNaN(e.getTime())?null:S(e.getFullYear(),e.getMonth(),e.getDate())}var at=g("bg-background p-3 w-fit rounded-lg border"),Wt=g("flex flex-col w-fit gap-4"),rt=g("flex items-center justify-between gap-2 w-fit mb-4"),Ht=g("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),$t=g("flex"),it=g("text-muted-foreground font-normal text-center text-[0.8rem] w-8"),jt=g("flex w-full mt-2"),ot=g("p-0 relative focus-within:relative focus-within:z-20 flex mt-1 h-8 w-8 text-sm"),st=g("p-0 font-normal flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground w-full h-full text-sm",{variants:{selected:{true:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",false:""},today:{true:"bg-accent text-accent-foreground",false:""},outside:{true:"text-muted-foreground opacity-50",false:""},disabled:{true:"text-muted-foreground opacity-50 cursor-not-allowed",false:""},rangeStart:{true:"rounded-r-none bg-primary text-primary-foreground",false:""},rangeEnd:{true:"rounded-l-none bg-primary text-primary-foreground",false:""},inRange:{true:"rounded-none bg-accent hover:bg-accent",false:""}},compoundVariants:[{today:!0,selected:!1,rangeStart:!1,rangeEnd:!1,inRange:!1,className:"bg-accent text-accent-foreground"},{today:!0,selected:!0,className:"bg-primary text-primary-foreground"},{rangeStart:!0,rangeEnd:!0,className:"rounded-md bg-primary text-primary-foreground"}],defaultVariants:{selected:!1,today:!1,outside:!1,disabled:!1,rangeStart:!1,rangeEnd:!1,inRange:!1}});var Dt=["gridContainer"],xt=(r,e)=>e.date.getTime();function Mt(r,e){if(r&1&&(q(0,"div",5),z(1),G()),r&2){let t=e.$implicit,n=b();h(n.weekdayClasses()),d(),Ce(" ",t," ")}}function _t(r,e){if(r&1){let t=Q();q(0,"div",6)(1,"button",7),Ae("click",function(){let a=T(t),i=a.$implicit,o=a.$index,l=b();return k(l.onDayClick(i.date,o))}),z(2),G()()}if(r&2){let t=e.$implicit,n=e.$index,a=b();h(a.dayContainerClasses()),d(),h(a.dayButtonClasses(t)),Ze("id",a.getDayId(n))("disabled",t.isDisabled),M("aria-selected",t.isSelected)("aria-label",a.getDayAriaLabel(t))("tabindex",a.getFocusedDayIndex()===n?0:-1),d(),Ce(" ",t.date.getDate()," ")}}var W=class r{constructor(){this.gridContainer=L.required("gridContainer");this.calendarDays=s.required();this.disabled=s(!1);this.dateSelect=C();this.previousMonth=C();this.nextMonth=C();this.previousYear=C();this.nextYear=C();this.weekdays=["Su","Mo","Tu","We","Th","Fr","Sa"];this.focusedDayIndex=x(-1);this.weekdayClasses=c(()=>u(it()));this.dayContainerClasses=c(()=>u(ot()))}dayButtonClasses(e){return u(st({selected:e.isSelected,today:e.isToday,outside:!e.isCurrentMonth,disabled:e.isDisabled,rangeStart:e.isRangeStart??!1,rangeEnd:e.isRangeEnd??!1,inRange:e.isInRange??!1}))}onDayClick(e,t){this.disabled()||(this.focusedDayIndex.set(t),this.dateSelect.emit({date:e,index:t}))}getDayId(e){return Me(e)}getDayAriaLabel(e){return nt(e)}getFocusedDayIndex(){let e=this.focusedDayIndex();if(e>=0)return e;let t=this.calendarDays(),n=t.findIndex(o=>o.isSelected);if(n>=0)return n;let a=t.findIndex(o=>o.isToday&&o.isCurrentMonth);if(a>=0)return a;let i=t.findIndex(o=>o.isCurrentMonth&&!o.isDisabled);return i>=0?i:0}setFocusedDayIndex(e){this.focusedDayIndex.set(e),this.setFocus(e)}resetFocus(){let e=this.getFocusedDayIndex();this.setFocus(e)}onKeyDown(e){if(this.disabled())return;let t=e,n=this.calendarDays();if(n.length===0)return;let a=this.getFocusedDayIndex(),i=null;switch(t.key){case"ArrowLeft":i=this.navigate(a,-1,n);break;case"ArrowRight":i=this.navigate(a,1,n);break;case"ArrowUp":i=this.navigate(a,-7,n);break;case"ArrowDown":i=this.navigate(a,7,n);break;case"Home":i=this.findEnabledInRange(Math.floor(a/7)*7,Math.floor(a/7)*7+6,n);break;case"End":i=this.findEnabledInRange(Math.floor(a/7)*7+6,Math.floor(a/7)*7,n,!0);break;case"PageUp":t.ctrlKey?this.previousYear.emit():this.previousMonth.emit({position:"default",dayOfWeek:-1});break;case"PageDown":t.ctrlKey?this.nextYear.emit():this.nextMonth.emit({position:"default",dayOfWeek:-1});break;case"Enter":case" ":{let o=n[a];o&&!o.isDisabled&&this.dateSelect.emit({date:o.date,index:a});break}default:break}i!==null&&i!==a&&this.setFocus(i)}navigate(e,t,n){let a=e+t;if(a>=0&&a<n.length)return this.findEnabledInRange(a,e,n);let i=e%7;return t===-1?this.previousMonth.emit({position:"last",dayOfWeek:-1}):t===1?this.nextMonth.emit({position:"first",dayOfWeek:-1}):t===-7?this.previousMonth.emit({position:"lastWeek",dayOfWeek:i}):t===7&&this.nextMonth.emit({position:"firstWeek",dayOfWeek:i}),null}findEnabledInRange(e,t,n,a=!1){let i=Math.max(0,Math.min(e,n.length-1)),o=Math.max(0,Math.min(t,n.length-1));if(a){for(let l=i;l>=0;l--)if(!n[l].isDisabled)return l;for(let l=i+1;l<n.length;l++)if(!n[l].isDisabled)return l}else{for(let l=i;l<n.length;l++)if(!n[l].isDisabled)return l;for(let l=i-1;l>=0;l--)if(!n[l].isDisabled)return l}return o}setFocus(e){this.focusedDayIndex.set(e),setTimeout(()=>{this.gridContainer()?.nativeElement.querySelector(`#${Me(e)}`)?.focus()},0)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=D({type:r,selectors:[["z-calendar-grid"]],viewQuery:function(t,n){t&1&&P(n.gridContainer,Dt,5),t&2&&F()},hostAttrs:[1,"flex","justify-center"],hostVars:1,hostBindings:function(t,n){t&1&&v("keydown.{arrowleft,arrowright,arrowup,arrowdown,home,end,pageup,pagedown,enter,space}.prevent",function(i){return n.onKeyDown(i)}),t&2&&M("role","grid")},inputs:{calendarDays:[1,"calendarDays"],disabled:[1,"disabled"]},outputs:{dateSelect:"dateSelect",previousMonth:"previousMonth",nextMonth:"nextMonth",previousYear:"previousYear",nextYear:"nextYear"},exportAs:["zCalendarGrid"],decls:8,vars:0,consts:[["gridContainer",""],["role","row",1,"grid","w-fit","grid-cols-7","text-center"],["role","columnheader",3,"class"],["role","rowgroup",1,"mt-2","grid","w-fit","auto-rows-min","grid-cols-7","gap-0"],["role","gridcell",3,"class"],["role","columnheader"],["role","gridcell"],["type","button","role","button",3,"click","id","disabled"]],template:function(t,n){t&1&&(q(0,"div",null,0)(2,"div",1),V(3,Mt,2,3,"div",2,A),G(),q(5,"div",3),V(6,_t,3,10,"div",4,xt),G()()),t&2&&(d(3),I(n.weekdays),d(3),I(n.calendarDays()))},encapsulation:2,changeDetection:0})}};var lt=g(u("relative inline-block w-full rounded-md group data-active:border data-active:border-ring data-active:ring-ring/50 data-active:ring-[3px]","[&_button]:focus-visible:border [&_button]:focus-visible:border-ring [&_button]:focus-visible:ring-ring/50 [&_button]:focus-visible:ring-[3px]")),dt=g(u("flex w-full items-center justify-between gap-2 rounded-md border border-input","bg-white","shadow-xs transition-[color,box-shadow] outline-none cursor-pointer disabled:cursor-not-allowed",'disabled:opacity-50 data-placeholder:text-muted-foreground [&_svg:not([class*="text-"])]:text-muted-foreground',"hover:bg-gray-50","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40",'aria-invalid:border-destructive [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*="size-"])]:size-4'),{variants:{zSize:{sm:"min-h-8 py-1 text-xs px-2",default:"min-h-9 py-1.5 px-3 text-sm",lg:"min-h-10 py-2 text-base px-4"}},defaultVariants:{zSize:"default"}}),ct=g(u("min-w-full scrollbar-hide overflow-y-auto rounded-md border border-gray-200","bg-white","text-gray-900","shadow-sm animate-in fade-in-0 zoom-in-95","relative"),{variants:{},defaultVariants:{}}),ut=g(u("relative flex min-w-full cursor-pointer text-nowrap items-center gap-2 rounded-sm mb-0.5","outline-hidden select-none","text-gray-900 ","hover:bg-gray-100 ","hover:text-gray-900 ","data-selected:bg-gray-100 ","data-selected:text-gray-900 ","data-disabled:pointer-events-none data-disabled:opacity-50 data-disabled:cursor-not-allowed","data-disabled:hover:bg-transparent data-disabled:hover:text-current",'[&_svg:not([class*="text-"])]:text-muted-foreground [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*="size-"])]:size-4'),{variants:{zSize:{sm:"min-h-8 py-1 text-xs",default:"min-h-9 py-1.5 text-sm",lg:"min-h-10 py-2 text-base"},zMode:{normal:"pr-8 pl-2",compact:"pl-6.5 pr-2"}},compoundVariants:[{zMode:"compact",zSize:"sm",class:"pl-5 pr-2"}]}),pt=g("absolute flex size-3.5 items-center justify-center",{variants:{zSize:{sm:"",default:"",lg:""},zMode:{normal:"right-2",compact:"left-2"}},compoundVariants:[{zMode:"compact",zSize:"sm",class:"left-1"}]});var zt=["*"];function St(r,e){if(r&1&&(p(0,"span"),E(1,"z-icon",2),m()),r&2){let t=b();h(t.iconClasses()),d(),y("zStrokeWidth",t.strokeWidth())}}var Z=class r{constructor(){this.elementRef=_(oe);this.zValue=s.required();this.zDisabled=s(!1,{transform:ce});this.class=s("");this.select=x(null);this.noopFn=Qe;this.label=K(()=>{let e=this.elementRef.nativeElement;return(e.textContent??e.innerText)?.trim()??""});this.zMode=x("normal");this.zSize=x("default");this.classes=c(()=>u(ut({zMode:this.zMode(),zSize:this.zSize()}),this.class()));this.iconClasses=c(()=>u(pt({zMode:this.zMode(),zSize:this.zSize()})));this.strokeWidth=c(()=>this.zMode()==="compact"?3:2);this.isSelected=c(()=>this.select()?.selectedValue().includes(this.zValue())??!1)}setSelectHost(e){this.select.set(e)}onMouseEnter(){this.zDisabled()||this.select()?.navigateTo()}onClick(){this.zDisabled()||this.select()?.selectItem(this.zValue(),this.label())}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=D({type:r,selectors:[["z-select-item"],["","z-select-item",""]],hostAttrs:["role","option","tabindex","-1"],hostVars:6,hostBindings:function(t,n){t&1&&v("click",function(){return n.onClick()})("mouseenter",function(){return n.onMouseEnter()})("keydown.{tab}.prevent",function(){return n.noopFn}),t&2&&(M("value",n.zValue())("data-disabled",n.zDisabled()?"":null)("data-selected",n.isSelected()?"":null)("aria-selected",n.isSelected()),h(n.classes()))},inputs:{zValue:[1,"zValue"],zDisabled:[1,"zDisabled"],class:[1,"class"]},ngContentSelectors:zt,decls:3,vars:1,consts:[[3,"class"],[1,"truncate"],["zType","check","aria-hidden","true",3,"zStrokeWidth"]],template:function(t,n){t&1&&(Y(),se(0,St,2,3,"span",0),p(1,"span",1),O(2),m()),t&2&&le(n.isSelected()?0:-1)},dependencies:[B],encapsulation:2,changeDetection:0})}};var mt=g("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{zType:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"},zShape:{default:"rounded-md",square:"rounded-none",pill:"rounded-full"}},defaultVariants:{zType:"default",zShape:"default"}});var wt=["*"],pe=class r{constructor(){this.zType=s("default");this.zShape=s("default");this.class=s("");this.classes=c(()=>u(mt({zType:this.zType(),zShape:this.zShape()}),this.class()))}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=D({type:r,selectors:[["z-badge"]],hostVars:2,hostBindings:function(t,n){t&2&&h(n.classes())},inputs:{zType:[1,"zType"],zShape:[1,"zShape"],class:[1,"class"]},exportAs:["zBadge"],ngContentSelectors:wt,decls:1,vars:0,template:function(t,n){t&1&&(Y(),O(0))},encapsulation:2,changeDetection:0})}};var Vt=["dropdownTemplate"],It=["*"],Nt=r=>({$implicit:r});function Tt(r,e){r&1&&Re(0)}function kt(r,e){if(r&1&&be(0,Tt,1,0,"ng-container",6),r&2){let t=e.$implicit;b();let n=Oe(7);y("ngTemplateOutlet",n)("ngTemplateOutletContext",Pe(2,Nt,t))}}function Et(r,e){if(r&1&&(p(0,"span",4),z(1),m()),r&2){let t=b();d(),R(t.zPlaceholder())}}function Ft(r,e){if(r&1&&(p(0,"z-badge",7)(1,"span",8),z(2),m()()),r&2){let t=b().$implicit;d(2),R(t)}}function Rt(r,e){if(r&1&&(p(0,"span",8),z(1),m()),r&2){let t=b().$implicit;d(),R(t)}}function Zt(r,e){if(r&1&&se(0,Ft,3,1,"z-badge",7)(1,Rt,2,1,"span",8),r&2){let t=b();le(t.zMultiple()?0:1)}}function At(r,e){if(r&1){let t=Q();p(0,"div",9),v("keydown.{arrowdown,arrowup,enter,space,escape,home,end}.prevent",function(a){T(t);let i=b();return k(i.onDropdownKeydown(a))}),p(1,"div",10),O(2),m()()}if(r&2){let t=b();h(t.contentClasses()),M("data-state","open")}}var Yt=100,me=class r{constructor(){this.destroyRef=_(Ne);this.elementRef=_(oe);this.injector=_(Ie);this.overlay=_(qe);this.overlayPositionBuilder=_(je);this.viewContainerRef=_(Ee);this.platformId=_(Te);this.dropdownTemplate=L.required("dropdownTemplate");this.selectItems=Le(Z);this.class=s("");this.zDisabled=s(!1,{transform:ce});this.zLabel=s("");this.zMaxLabelCount=s(1);this.zMultiple=s(!1);this.zPlaceholder=s("Select an option...");this.zSize=s("default");this.zValue=U(this.zMultiple()?[]:"");this.zSelectionChange=C();this.isOpen=x(!1);this.focusedIndex=x(-1);this.isFocus=x(!1);this.isCompact=x(!1);this.selectedLabels=c(()=>{let e=this.zValue();return this.zMultiple()&&Array.isArray(e)?this.provideLabelsForMultiselectMode(e):this.provideLabelForSingleSelectMode(e)});this.onChange=e=>{};this.onTouched=()=>{};this.classes=c(()=>u(lt(),this.class()));this.contentClasses=c(()=>u(ct()));this.triggerClasses=c(()=>u(dt({zSize:this.zSize()})))}onFocus(){this.isCompact()&&this.isFocus.set(!0)}ngAfterContentInit(){let e=this.elementRef.nativeElement.offsetWidth||0,t=0;for(let n of this.selectItems())n.setSelectHost({selectedValue:()=>this.zMultiple()?this.zValue():[this.zValue()],selectItem:(a,i)=>this.selectItem(a,i),navigateTo:()=>this.navigateTo(n,t)}),n.zSize.set(this.zSize()),t++,e<=Yt&&(this.isCompact.set(!0),n.zMode.set("compact"))}ngOnDestroy(){this.destroyOverlay()}onTriggerKeydown(e){let{key:t}=e;switch(t){case"Enter":case" ":case"ArrowDown":case"ArrowUp":this.isOpen()||this.open();break;case"Escape":this.isOpen()&&this.close();break}}onDropdownKeydown(e){let{key:t}=e,n=this.getSelectItems();switch(t){case"ArrowDown":this.navigateItems(1,n);break;case"ArrowUp":this.navigateItems(-1,n);break;case"Enter":case" ":this.selectFocusedItem(n);break;case"Escape":this.close(),this.focusButton();break;case"Home":this.focusFirstItem(n);break;case"End":this.focusLastItem(n);break}}toggle(){this.zDisabled()||(this.isOpen()?this.close():this.open())}selectItem(e,t){if(e==null){console.warn("Attempted to select item with invalid value:",{value:e,label:t});return}this.zValue.update(n=>Array.isArray(n)?n.includes(e)?n.filter(a=>a!==e):[...n,e]:e),this.onChange(e),this.zSelectionChange.emit(this.zValue()),this.zMultiple()?this.updateOverlayPosition():(this.close(),setTimeout(()=>{this.focusButton()},0))}navigateTo(e,t){this.focusedIndex.set(t),this.updateItemFocus(this.getSelectItems(!0),t)}updateOverlayPosition(){setTimeout(()=>{this.overlayRef?.updatePosition()},0)}provideLabelsForMultiselectMode(e){let t=e.length-this.zMaxLabelCount(),n=[],a=0;for(let i of e){let o=this.getMatchingItem(i);if(o&&(n.push(o.label()),a++),t&&this.zMaxLabelCount()&&a===this.zMaxLabelCount()){n.push(`${t} more item${t>1?"s":""} selected`);break}}return n}provideLabelForSingleSelectMode(e){let t=this.zLabel();if(t)return[t];let n=this.getMatchingItem(e);return n?[n.label()]:e?[e]:[]}open(){if(this.isOpen()||(this.overlayRef||this.createOverlay(),!this.overlayRef))return;let e=this.elementRef.nativeElement.offsetWidth||0;this.overlayRef.hasAttached()&&this.overlayRef.detach(),this.portal=new $e(this.dropdownTemplate(),this.viewContainerRef),this.overlayRef.attach(this.portal),this.overlayRef.updateSize({width:e}),this.isOpen.set(!0),this.updateFocusWhenNormalMode(),this.determinePortalWidthOnOpen(e)}setFocusOnOpen(){this.focusDropdown(),this.focusSelectedItem()}close(){this.overlayRef?.hasAttached()&&this.overlayRef.detach(),this.isOpen.set(!1),this.focusedIndex.set(-1),this.onTouched(),this.updateFocusWhenNormalMode()}updateFocusWhenNormalMode(){this.isCompact()||this.isFocus.set(!this.isOpen())}getMatchingItem(e){return this.selectItems()?.find(t=>t.zValue()===e)}determinePortalWidthOnOpen(e){Ve(this.injector,()=>{ke(()=>{if(!this.overlayRef||!this.overlayRef.hasAttached())return;let t=this.overlayRef.overlayElement,n=Array.from(t.querySelectorAll("z-select-item > span.truncate, [z-select-item] > span.truncate")),a=!1;for(let f of n)if(f.scrollWidth>f.clientWidth+1){a=!0;break}if(!a){this.setFocusOnOpen();return}let i=this.selectItems(),o=0;for(let f of i)o=Math.max(o,f.elementRef.nativeElement.scrollWidth);let[l]=i;if(a&&l){let f=getComputedStyle(l.elementRef.nativeElement),fe=Number.parseFloat(f.getPropertyValue("padding-left"))||0,he=Number.parseFloat(f.getPropertyValue("padding-right"))||0;o+=fe+he}o=Math.max(o,e),this.overlayRef.updateSize({width:o}),this.overlayRef.updatePosition(),this.setFocusOnOpen()})})}createOverlay(){if(!this.overlayRef&&He(this.platformId))try{let e=this.overlayPositionBuilder.flexibleConnectedTo(this.elementRef).withPositions([{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top",offsetY:4},{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom",offsetY:-4}]).withPush(!1),t=this.elementRef.nativeElement.offsetWidth||200;this.overlayRef=this.overlay.create({positionStrategy:e,hasBackdrop:!1,scrollStrategy:this.overlay.scrollStrategies.reposition(),width:t,maxHeight:384,panelClass:["z-select-overlay-pane"]}),this.overlayRef.outsidePointerEvents().pipe(re(n=>!this.elementRef.nativeElement.contains(n.target)),Ue(this.destroyRef)).subscribe(()=>{this.isFocus.set(!1),this.close()})}catch(e){console.error("Error creating overlay:",e)}}destroyOverlay(){this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=void 0)}getSelectItems(e=!1){if(!this.overlayRef?.hasAttached())return[];let t=this.overlayRef.overlayElement;return Array.from(t.querySelectorAll("z-select-item, [z-select-item]")).filter(n=>e||n.dataset.disabled===void 0)}navigateItems(e,t){if(t.length===0)return;let a=this.focusedIndex()+e;a<0?a=t.length-1:a>=t.length&&(a=0),this.focusedIndex.set(a),this.updateItemFocus(t,a)}selectFocusedItem(e){let t=this.focusedIndex();if(t>=0&&t<e.length){let n=e[t],a=n.getAttribute("value"),i=n.textContent?.trim()??"";if(a==null){console.warn("No value attribute found on selected item:",n);return}this.selectItem(a,i)}}focusFirstItem(e){e.length>0&&(this.focusedIndex.set(0),this.updateItemFocus(e,0))}focusLastItem(e){if(e.length>0){let t=e.length-1;this.focusedIndex.set(t),this.updateItemFocus(e,t)}}updateItemFocus(e,t){for(let n=0;n<e.length;n++){let a=e[n];n===t?(a.focus(),a.setAttribute("aria-selected","true"),a.setAttribute("data-selected","true")):(a.removeAttribute("aria-selected"),a.removeAttribute("data-selected"))}}focusDropdown(){if(this.overlayRef?.hasAttached()){let e=this.overlayRef.overlayElement.querySelector('[role="listbox"]');e&&e.focus()}}focusButton(){let e=this.elementRef.nativeElement.querySelector("button");e&&e.focus()}focusSelectedItem(){let e=this.getSelectItems();if(e.length===0)return;let t;Array.isArray(this.zValue())&&this.zValue().length?[t]=this.zValue():t=this.zValue();let n=e.findIndex(a=>a.getAttribute("value")===t);n===-1&&(n=0),this.focusedIndex.set(n),this.updateItemFocus(e,n)}writeValue(e){this.zMultiple()&&Array.isArray(e)?this.zValue.set(e):this.zValue.set(e??"")}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(){}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=D({type:r,selectors:[["z-select"],["","z-select",""]],contentQueries:function(t,n,a){t&1&&Ye(a,n.selectItems,Z,4),t&2&&F()},viewQuery:function(t,n){t&1&&P(n.dropdownTemplate,Vt,5),t&2&&F()},hostVars:5,hostBindings:function(t,n){t&1&&v("keydown.{enter,space,arrowdown,arrowup,escape}.prevent",function(i){return n.onTriggerKeydown(i)}),t&2&&(M("data-active",n.isFocus()?"":null)("data-disabled",n.zDisabled()?"":null)("data-state",n.isOpen()?"open":"closed"),h(n.classes()))},inputs:{class:[1,"class"],zDisabled:[1,"zDisabled"],zLabel:[1,"zLabel"],zMaxLabelCount:[1,"zMaxLabelCount"],zMultiple:[1,"zMultiple"],zPlaceholder:[1,"zPlaceholder"],zSize:[1,"zSize"],zValue:[1,"zValue"]},outputs:{zValue:"zValueChange",zSelectionChange:"zSelectionChange"},features:[de([{provide:ue,useExisting:ie(()=>r),multi:!0}])],ngContentSelectors:It,decls:10,vars:7,consts:[["labelsTemplate",""],["dropdownTemplate",""],["type","button","role","combobox","aria-controls","dropdown",3,"blur","click","focus","disabled"],[1,"flex","flex-1","flex-wrap","items-center","gap-2"],[1,"text-muted-foreground","truncate"],["zType","chevron-down","zSize","lg",1,"opacity-50"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["zType","secondary"],[1,"truncate"],["id","dropdown","role","listbox","tabindex","-1",3,"keydown.{arrowdown,arrowup,enter,space,escape,home,end}.prevent"],[1,"p-1"]],template:function(t,n){if(t&1){let a=Q();Y(),p(0,"button",2),v("blur",function(){return T(a),k(!n.isOpen()&&n.isFocus.set(!1))})("click",function(){return T(a),k(n.toggle())})("focus",function(){return T(a),k(n.onFocus())}),p(1,"span",3),V(2,kt,1,4,"ng-container",null,A,!1,Et,2,1,"span",4),m(),E(5,"z-icon",5),m(),be(6,Zt,2,1,"ng-template",null,0,De)(8,At,3,3,"ng-template",null,1,De)}if(t&2){h(n.triggerClasses()),y("disabled",n.zDisabled()),M("aria-expanded",n.isOpen())("aria-haspopup","listbox")("data-placeholder",n.zValue()?null:"");let a=n.selectedLabels();d(2),I(a)}},dependencies:[We,Be,Ge,pe,B],encapsulation:2,changeDetection:0})}};function Ot(r,e){if(r&1&&(p(0,"z-select-item",4),z(1),m()),r&2){let t=e.$implicit,n=e.$index;y("zValue",n.toString()),d(),R(t)}}function Pt(r,e){if(r&1&&(p(0,"z-select-item",4),z(1),m()),r&2){let t=e.$implicit;y("zValue",t.toString()),d(),R(t)}}var ge=class r{constructor(){this.currentMonth=s.required();this.currentYear=s.required();this.minDate=s(null);this.maxDate=s(null);this.disabled=s(!1);this.monthChange=C();this.yearChange=C();this.previousMonth=C();this.nextMonth=C();this.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];this.navClasses=c(()=>u(rt()));this.availableYears=c(()=>{let e=this.minDate()?.getFullYear()??new Date().getFullYear()-10,t=this.maxDate()?.getFullYear()??new Date().getFullYear()+10,n=[];for(let a=e;a<=t;a++)n.push(a);return n});this.currentMonthName=c(()=>{let e=Number.parseInt(this.currentMonth());return!Number.isNaN(e)&&this.months[e]?this.months[e]:this.months[new Date().getMonth()]})}isPreviousDisabled(){if(this.disabled())return!0;let e=this.minDate();if(!e)return!1;let t=Number.parseInt(this.currentMonth()),n=Number.parseInt(this.currentYear());return new Date(n,t,0).getTime()<e.getTime()}isNextDisabled(){if(this.disabled())return!0;let e=this.maxDate();if(!e)return!1;let t=Number.parseInt(this.currentMonth()),n=Number.parseInt(this.currentYear());return new Date(n,t+1,1).getTime()>e.getTime()}onPreviousClick(){this.previousMonth.emit()}onNextClick(){this.nextMonth.emit()}onMonthChange(e){if(Array.isArray(e)){console.warn("Calendar navigation received array for month selection, expected single value. Ignoring:",e);return}this.monthChange.emit(e)}onYearChange(e){if(Array.isArray(e)){console.warn("Calendar navigation received array for year selection, expected single value. Ignoring:",e);return}this.yearChange.emit(e)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=D({type:r,selectors:[["z-calendar-navigation"]],inputs:{currentMonth:[1,"currentMonth"],currentYear:[1,"currentYear"],minDate:[1,"minDate"],maxDate:[1,"maxDate"],disabled:[1,"disabled"]},outputs:{monthChange:"monthChange",yearChange:"yearChange",previousMonth:"previousMonth",nextMonth:"nextMonth"},exportAs:["zCalendarNavigation"],decls:12,vars:8,consts:[["type","button","z-button","","zType","ghost","zSize","sm","aria-label","Previous month",1,"h-7","w-7","p-0",3,"click","disabled"],["zType","chevron-left"],[1,"flex","items-center","space-x-2"],[3,"zSelectionChange","zValue","zLabel"],[3,"zValue"],["type","button","z-button","","zType","ghost","zSize","sm","aria-label","Next month",1,"h-7","w-7","p-0",3,"click","disabled"],["zType","chevron-right"]],template:function(t,n){t&1&&(p(0,"div")(1,"button",0),v("click",function(){return n.onPreviousClick()}),E(2,"z-icon",1),m(),p(3,"div",2)(4,"z-select",3),v("zSelectionChange",function(i){return n.onMonthChange(i)}),V(5,Ot,2,2,"z-select-item",4,A),m(),p(7,"z-select",3),v("zSelectionChange",function(i){return n.onYearChange(i)}),V(8,Pt,2,2,"z-select-item",4,Fe),m()(),p(10,"button",5),v("click",function(){return n.onNextClick()}),E(11,"z-icon",6),m()()),t&2&&(h(n.navClasses()),d(),y("disabled",n.isPreviousDisabled()),d(3),y("zValue",n.currentMonth())("zLabel",n.currentMonthName()),d(),I(n.months),d(2),y("zValue",n.currentYear())("zLabel",n.currentYear()),d(),I(n.availableYears()),d(2),y("disabled",n.isNextDisabled()))},dependencies:[Ke,B,me,Z],encapsulation:2,changeDetection:0})}};var gt=class r{constructor(){this.gridRef=L.required(W);this.class=s("");this.zMode=s("single");this.value=U(null);this.minDate=s(null);this.maxDate=s(null);this.disabled=U(!1);this.dateChange=Xe(Je(this.value).pipe(we(e=>_e(e)),re(e=>e!==null)));this.onChange=()=>{};this.onTouched=()=>{};this.normalizedValue=c(()=>_e(this.value()));this.currentDate=c(()=>{let e=this.normalizedValue(),t=this.zMode();return e?t==="single"?e:Array.isArray(e)&&e.length>0?e[0]:new Date:new Date});this.currentMonthValue=K(()=>this.currentDate().getMonth().toString());this.currentYearValue=K(()=>this.currentDate().getFullYear().toString());this.classes=c(()=>u(at(),this.class()));this.calendarDays=c(()=>{let e=this.currentDate(),t=S(Number.parseInt(this.currentYearValue()),Number.parseInt(this.currentMonthValue()),e.getDate()),n=Number.isNaN(t.getTime())?e:t;return et({year:n.getFullYear(),month:n.getMonth(),mode:this.zMode(),selectedDates:tt(this.normalizedValue(),this.zMode()),minDate:this.minDate(),maxDate:this.maxDate(),disabled:this.disabled()})})}resetNavigation(){let e=this.currentDate();this.currentMonthValue.set(e.getMonth().toString()),this.currentYearValue.set(e.getFullYear().toString()),this.gridRef().setFocusedDayIndex(-1)}onMonthChange(e){if(Array.isArray(e)){console.warn("Calendar received array for month selection, expected single value. Ignoring:",e);return}if(!e||e.trim()===""){console.warn("Invalid month index received:",e);return}let t=Number.parseInt(e,10);if(Number.isNaN(t)||t<0||t>11){console.warn("Invalid month value:",e,"parsed as:",t);return}let n=this.currentDate(),a=Number.parseInt(this.currentYearValue()),i=S(Number.isNaN(a)?n.getFullYear():a,t,1);this.currentMonthValue.set(i.getMonth().toString()),this.gridRef().setFocusedDayIndex(-1)}onYearChange(e){if(Array.isArray(e)){console.warn("Calendar received array for year selection, expected single value. Ignoring:",e);return}if(!e||e.trim()===""){console.warn("Invalid year received:",e);return}let t=Number.parseInt(e,10);if(Number.isNaN(t)||t<1900||t>2100){console.warn("Invalid year value:",e,"parsed as:",t);return}let n=this.currentDate(),a=Number.parseInt(this.currentMonthValue()),i=S(t,Number.isNaN(a)?n.getMonth():a,1);this.currentYearValue.set(i.getFullYear().toString()),this.gridRef().setFocusedDayIndex(-1)}previousMonth(){let e=Number.parseInt(this.currentMonthValue()),t=Number.parseInt(this.currentYearValue()),n=S(t,e-1,1);this.currentMonthValue.set(n.getMonth().toString()),this.currentYearValue.set(n.getFullYear().toString()),this.gridRef().setFocusedDayIndex(-1)}nextMonth(){let e=Number.parseInt(this.currentMonthValue()),t=Number.parseInt(this.currentYearValue()),n=S(t,e+1,1);this.currentMonthValue.set(n.getMonth().toString()),this.currentYearValue.set(n.getFullYear().toString()),this.gridRef().setFocusedDayIndex(-1)}navigateYear(e){let t=this.currentDate(),n=S(t.getFullYear()+e,t.getMonth(),1);this.currentYearValue.set(n.getFullYear().toString()),setTimeout(()=>this.gridRef().resetFocus(),0)}onGridPreviousMonth(e){this.previousMonth(),setTimeout(()=>this.resetFocusAfterNavigation(e.position,e.dayOfWeek),0)}onGridNextMonth(e){this.nextMonth(),setTimeout(()=>this.resetFocusAfterNavigation(e.position,e.dayOfWeek),0)}onDateSelect(e){this.selectDate(e.date)}selectDate(e){if(this.disabled())return;let t=this.zMode(),n=this.normalizedValue();if(t==="single")this.value.set(e);else if(t==="multiple"){let a=Array.isArray(n)?[...n]:[],i=a.findIndex(o=>N(o,e));i>=0?a.splice(i,1):a.push(e),this.value.set(a.length>0?a:null)}else if(t==="range"){let a=Array.isArray(n)?[...n]:[];if(a.length===0)this.value.set([e]);else if(a.length===1){let i=a[0];e.getTime()<i.getTime()?this.value.set([e,i]):N(e,i)?this.value.set(null):this.value.set([i,e])}else this.value.set([e])}this.onChange(this.normalizedValue()),this.onTouched()}resetFocusAfterNavigation(e="default",t=-1){let n=this.calendarDays(),a=-1;switch(e){case"first":a=n.findIndex(i=>!i.isDisabled);break;case"last":for(let i=n.length-1;i>=0;i--)if(!n[i].isDisabled){a=i;break}break;case"firstWeek":t>=0&&t<7&&(a=this.findEnabledInRange(t,0,n));break;case"lastWeek":if(t>=0){let i=Math.floor((n.length-1)/7)*7,o=Math.min(i+t,n.length-1);a=this.findEnabledInRange(o,n.length-1,n)}break;default:{let i=n.findIndex(f=>f.isSelected),o=n.findIndex(f=>f.isToday&&f.isCurrentMonth),l=n.findIndex(f=>f.isCurrentMonth&&!f.isDisabled);a=i>=0?i:o>=0?o:Math.max(l,0);break}}a>=0&&this.gridRef().setFocusedDayIndex(a)}findEnabledInRange(e,t,n){let a=Math.max(0,Math.min(e,n.length-1)),i=Math.max(0,Math.min(t,n.length-1));for(let o=a;o<n.length;o++)if(!n[o].isDisabled)return o;for(let o=a-1;o>=0;o--)if(!n[o].isDisabled)return o;return i}writeValue(e){this.value.set(e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled.set(e)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=D({type:r,selectors:[["z-calendar"],["","z-calendar",""]],viewQuery:function(t,n){t&1&&P(n.gridRef,W,5),t&2&&F()},hostVars:1,hostBindings:function(t,n){t&2&&M("tabindex",0)},inputs:{class:[1,"class"],zMode:[1,"zMode"],value:[1,"value"],minDate:[1,"minDate"],maxDate:[1,"maxDate"],disabled:[1,"disabled"]},outputs:{value:"valueChange",disabled:"disabledChange",dateChange:"dateChange"},exportAs:["zCalendar"],features:[de([{provide:ue,useExisting:ie(()=>r),multi:!0}])],decls:3,vars:9,consts:[[3,"monthChange","yearChange","previousMonth","nextMonth","currentMonth","currentYear","minDate","maxDate","disabled"],[3,"dateSelect","previousMonth","nextMonth","previousYear","nextYear","calendarDays","disabled"]],template:function(t,n){t&1&&(p(0,"div")(1,"z-calendar-navigation",0),v("monthChange",function(i){return n.onMonthChange(i)})("yearChange",function(i){return n.onYearChange(i)})("previousMonth",function(){return n.previousMonth()})("nextMonth",function(){return n.nextMonth()}),m(),p(2,"z-calendar-grid",1),v("dateSelect",function(i){return n.onDateSelect(i)})("previousMonth",function(i){return n.onGridPreviousMonth(i)})("nextMonth",function(i){return n.onGridNextMonth(i)})("previousYear",function(){return n.navigateYear(-1)})("nextYear",function(){return n.navigateYear(1)}),m()()),t&2&&(h(n.classes()),d(),y("currentMonth",n.currentMonthValue())("currentYear",n.currentYearValue())("minDate",n.minDate())("maxDate",n.maxDate())("disabled",n.disabled()),d(),y("calendarDays",n.calendarDays())("disabled",n.disabled()))},dependencies:[ge,W],encapsulation:2,changeDetection:0})}};export{gt as a};
