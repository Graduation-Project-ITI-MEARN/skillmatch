import{a as ie}from"./chunk-DVQSRTEW.js";import"./chunk-JJPBU5Z3.js";import"./chunk-YGBCOKBM.js";import"./chunk-2YIDOPGG.js";import"./chunk-2DHYFB3B.js";import{c as j,d as u,e as Y,f as Q,j as K,k as W,p as X,q as Z,w as J,x as ee,y as te}from"./chunk-CYRR275F.js";import{A as G,B,Ma as H,c as N,eb as q,jb as U,lb as $,mb as z,sa as P,v as V}from"./chunk-XQKT32VU.js";import{c as A,e as k,f as I}from"./chunk-GEE437AJ.js";import{a as R,c as O}from"./chunk-CADW372H.js";import"./chunk-EZWRTDAZ.js";import{b as F}from"./chunk-5FFKEXUF.js";import{k as D,l as M,s as T}from"./chunk-OAPWU2O3.js";import{Ac as c,Fb as s,Gb as r,Hb as t,Ib as g,Pb as w,Ub as x,Wa as i,Wb as f,_ as C,da as _,ea as y,f as E,ic as o,jc as b,kb as L,kc as m,pb as h,s as S,zc as d}from"./chunk-565OUHKP.js";function le(l,e){l&1&&(r(0,"div",7),g(1,"div",8),t())}function ae(l,e){if(l&1&&(r(0,"div",31)(1,"div",32),g(2,"lucide-icon",33),r(3,"div")(4,"h3",34),o(5,"Restricted Mode"),t(),r(6,"p",35),o(7),t()()()()),l&2){let n=f(2);i(2),s("img",n.icons.AlertTriangle),i(5),b(n.restrictedReason)}}function oe(l,e){if(l&1){let n=w();r(0,"li",38),x("click",function(){let p=_(n).$implicit,v=f(3);return y(v.selectCategory(p))}),o(1),t()}if(l&2){let n=e.$implicit;i(),m(" ",n," ")}}function se(l,e){if(l&1&&(r(0,"ul",36),h(1,oe,2,1,"li",37),t()),l&2){let n=f(2);i(),s("ngForOf",n.categories)}}function de(l,e){if(l&1){let n=w();r(0,"li",38),x("click",function(){let p=_(n).$implicit,v=f(3);return y(v.selectDifficulty(p))}),o(1),t()}if(l&2){let n=e.$implicit;i(),m(" ",n," ")}}function ce(l,e){if(l&1&&(r(0,"ul",36),h(1,de,2,1,"li",37),t()),l&2){let n=f(2);i(),s("ngForOf",n.difficultyLevels)}}function pe(l,e){l&1&&(r(0,"span"),o(1),d(2,"translate"),t()),l&2&&(i(),b(c(2,1,"CHALLENGE.FORM.UPDATE")))}function me(l,e){l&1&&(r(0,"span"),o(1),d(2,"translate"),t()),l&2&&(i(),b(c(2,1,"CHALLENGE.FORM.UPDATING")))}function ue(l,e){if(l&1){let n=w();r(0,"div",9)(1,"div",10)(2,"h1",11),o(3),d(4,"translate"),t(),r(5,"p",12),o(6),d(7,"translate"),t(),h(8,ae,8,2,"div",13),t(),r(9,"div",14)(10,"form",15),x("ngSubmit",function(){_(n);let p=f();return y(p.onSubmit())}),r(11,"div")(12,"label",16),o(13),d(14,"translate"),t(),g(15,"input",17),t(),r(16,"div",18)(17,"div")(18,"label",16),o(19),d(20,"translate"),t(),r(21,"div",19)(22,"button",20),x("click",function(){_(n);let p=f();return y(!p.isRestrictedMode&&(p.openCategory=!p.openCategory))}),r(23,"span"),o(24),d(25,"translate"),t(),g(26,"lucide-icon",21),t(),h(27,se,2,1,"ul",22),t()(),r(28,"div")(29,"label",16),o(30),d(31,"translate"),t(),r(32,"div",19)(33,"button",20),x("click",function(){_(n);let p=f();return y(!p.isRestrictedMode&&(p.openDifficulty=!p.openDifficulty))}),r(34,"span"),o(35),d(36,"translate"),t(),g(37,"lucide-icon",21),t(),h(38,ce,2,1,"ul",22),t()()(),r(39,"div")(40,"label",16),o(41),d(42,"translate"),t(),r(43,"z-calendar",23),x("dateChange",function(p){let v;_(n);let re=f();return y((v=re.challengeForm.get("deadline"))==null?null:v.setValue(p))}),t()(),r(44,"div")(45,"label",16),o(46),d(47,"translate"),t(),g(48,"input",24),t(),r(49,"div")(50,"label",16),o(51),d(52,"translate"),t(),g(53,"textarea",25),t(),r(54,"div")(55,"label",16),o(56),d(57,"translate"),t(),g(58,"textarea",26),t(),r(59,"div")(60,"label",16),o(61),d(62,"translate"),t(),g(63,"textarea",27),t(),r(64,"div")(65,"label",16),o(66),d(67,"translate"),t(),g(68,"textarea",28),t(),r(69,"button",29),h(70,pe,3,3,"span",30)(71,me,3,3,"span",30),t()()()()}if(l&2){let n,a=f();i(3),m(" ",c(4,24,"CHALLENGE.EDIT.TITLE")," "),i(3),b(c(7,26,"CHALLENGE.EDIT.DESCRIPTION")),i(2),s("ngIf",a.isRestrictedMode),i(2),s("formGroup",a.challengeForm),i(3),m("",c(14,28,"CHALLENGE.FORM.TITLE")," *"),i(6),m("",c(20,30,"CHALLENGE.FORM.CATEGORY")," *"),i(5),b(a.selectedCategory||c(25,32,"CHALLENGE.FORM.SELECT_CATEGORY")),i(2),s("img",a.icons.ChevronDown),i(),s("ngIf",a.openCategory),i(3),m("",c(31,34,"CHALLENGE.FORM.DIFFICULTY")," *"),i(5),b(a.selectedDifficulty||c(36,36,"CHALLENGE.FORM.SELECT_DIFFICULTY")),i(2),s("img",a.icons.ChevronDown),i(),s("ngIf",a.openDifficulty),i(3),m("",c(42,38,"CHALLENGE.FORM.DEADLINE")," *"),i(2),s("minDate",a.minDate)("value",(n=a.challengeForm.get("deadline"))==null?null:n.value),i(3),m("",c(47,40,"CHALLENGE.FORM.SALARY")," *"),i(5),m("",c(52,42,"CHALLENGE.FORM.DESCRIPTION")," *"),i(5),m("",c(57,44,"CHALLENGE.FORM.REQUIREMENTS")," *"),i(5),m("",c(62,46,"CHALLENGE.FORM.EVALUATION_CRITERIA")," *"),i(5),m("",c(67,48,"CHALLENGE.FORM.DELIVERABLES")," *"),i(3),s("disabled",a.isSubmitting),i(),s("ngIf",!a.isSubmitting),i(),s("ngIf",a.isSubmitting)}}var ne=class l{constructor(){this.fb=C(J);this.http=C(F);this.router=C(O);this.route=C(R);this.icons={ArrowLeft:N,CheckCircle:B,AlertCircle:G,AlertTriangle:q,Lock:P,ChevronDown:V,Search:H,X:U};this.isLoading=!0;this.isSubmitting=!1;this.submitError="";this.submitSuccess=!1;this.isRestrictedMode=!1;this.restrictedReason="";this.challengeData=null;this.categories=["Development","Design","Marketing","Writing","Translation","Data Entry"];this.difficultyLevels=["easy","medium","hard"];this.statusOptions=["draft","published","closed"];this.selectedTags=[];this.skillSearchQuery="";this.openSkillsDropdown=!1;this.selectedCategory=null;this.openCategory=!1;this.selectedDifficulty=null;this.openDifficulty=!1;this.selectedStatus="draft";this.openStatus=!1}ngOnInit(){return E(this,null,function*(){let e=new Date;e.setDate(e.getDate()+1),this.minDate=e,this.challengeId=this.route.snapshot.params.id,this.challengeForm=this.fb.group({title:["",[u.required,u.minLength(5)]],description:["",[u.required]],category:["",u.required],difficulty:["",u.required],status:["draft"],deadline:[null,u.required],salary:[null,[u.required,u.min(1e3)]],tags:[[],u.required],requirements:["",[u.required]],evaluationCriteria:["",[u.required]],deliverables:["",[u.required]]}),yield this.loadChallengeData()})}loadChallengeData(){return E(this,null,function*(){try{this.isLoading=!0;let e=yield S(this.http.get(`${I.apiUrl}/challenges/${this.challengeId}`));this.challengeData=e,this.checkRestrictedMode(),this.challengeForm.patchValue({title:e.title,description:e.description,category:e.category,difficulty:e.difficulty,status:e.status||"draft",deadline:e.deadline,salary:e.salary||e.prizeAmount,tags:e.tags||[],requirements:e.requirements,evaluationCriteria:e.evaluationCriteria,deliverables:e.deliverables}),this.selectedCategory=e.category,this.selectedDifficulty=e.difficulty,this.selectedStatus=e.status||"draft",this.selectedTags=e.tags||[],this.isRestrictedMode&&this.applyRestrictions()}catch{this.submitError="Failed to load challenge data"}finally{this.isLoading=!1}})}checkRestrictedMode(){let e=this.challengeData?.status,n=this.challengeData?.submissionsCount||0;e==="published"&&n>0&&(this.isRestrictedMode=!0,this.restrictedReason=`\u26A0\uFE0F Restricted Mode: ${n} active submissions detected. Core fields are locked.`)}applyRestrictions(){["title","category","difficulty","salary","tags"].forEach(e=>{this.challengeForm.get(e)?.disable()})}selectCategory(e){this.isRestrictedMode||(this.selectedCategory=e,this.openCategory=!1,this.challengeForm.get("category")?.setValue(e))}selectDifficulty(e){this.isRestrictedMode||(this.selectedDifficulty=e,this.openDifficulty=!1,this.challengeForm.get("difficulty")?.setValue(e))}selectStatus(e){this.selectedStatus=e,this.openStatus=!1,this.challengeForm.get("status")?.setValue(e)}toggleSkill(e){if(this.isRestrictedMode)return;let n=this.selectedTags.indexOf(e);n>-1?this.selectedTags.splice(n,1):this.selectedTags.push(e),this.challengeForm.get("tags")?.setValue(this.selectedTags)}onSubmit(){return E(this,null,function*(){if(this.challengeForm.invalid){this.submitError="Please fill all required fields correctly";return}try{this.isSubmitting=!0;let e=this.challengeForm.getRawValue();yield S(this.http.put(`${I.apiUrl}/challenges/${this.challengeId}`,e)),this.submitSuccess=!0,setTimeout(()=>this.router.navigate(["/dashboard/company/overview"]),2e3)}catch(e){this.submitError=e?.error?.message||"Update failed"}finally{this.isSubmitting=!1}})}goBack(){this.router.navigate(["/dashboard/company/overview"])}static{this.\u0275fac=function(n){return new(n||l)}}static{this.\u0275cmp=L({type:l,selectors:[["app-edit-challenge"]],decls:9,vars:6,consts:[[1,"min-h-screen","bg-linear-to-br","from-gray-50","to-blue-50","py-12","px-4"],[1,"max-w-5xl","mx-auto"],[1,"flex","items-center","gap-2","text-gray-600","hover:text-gray-900","mb-8","transition-colors",3,"click"],[1,"w-5","h-5",3,"img"],[1,"font-medium"],["class","flex justify-center py-20",4,"ngIf"],["class","grid grid-cols-1 lg:grid-cols-5 gap-8",4,"ngIf"],[1,"flex","justify-center","py-20"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-gray-900"],[1,"grid","grid-cols-1","lg:grid-cols-5","gap-8"],[1,"lg:col-span-2"],[1,"text-4xl","font-bold","text-gray-900","mb-4"],[1,"text-gray-600","text-lg","mb-8"],["class","mb-6 p-5 bg-amber-50 border-2 border-amber-300 rounded-xl",4,"ngIf"],[1,"lg:col-span-3"],[1,"bg-white","rounded-2xl","shadow-xl","p-8","space-y-6",3,"ngSubmit","formGroup"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","formControlName","title",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg","outline-none","focus:border-gray-900"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"relative"],["type","button",1,"flex","items-center","justify-between","w-full","px-4","py-3","border","border-gray-300","rounded-lg","bg-white",3,"click"],[1,"w-5","h-5","text-gray-500",3,"img"],["class","absolute z-20 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-xl",4,"ngIf"],[3,"dateChange","minDate","value"],["type","number","formControlName","salary",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg"],["formControlName","description","rows","4",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg"],["formControlName","requirements","rows","4",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg"],["formControlName","evaluationCriteria","rows","4",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg"],["formControlName","deliverables","rows","4",1,"w-full","px-4","py-3","border","border-gray-300","rounded-lg"],["type","submit",1,"w-full","px-6","py-4","bg-gray-900","text-white","rounded-xl","font-semibold","hover:bg-gray-800","shadow-lg","text-lg",3,"disabled"],[4,"ngIf"],[1,"mb-6","p-5","bg-amber-50","border-2","border-amber-300","rounded-xl"],[1,"flex","items-start","gap-3"],[1,"w-6","h-6","text-amber-600","shrink-0",3,"img"],[1,"font-bold","text-amber-900"],[1,"text-amber-800","text-sm"],[1,"absolute","z-20","mt-1","w-full","bg-white","border","border-gray-200","rounded-lg","shadow-xl"],["class","px-4 py-2 hover:bg-gray-50 cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"px-4","py-2","hover:bg-gray-50","cursor-pointer",3,"click"]],template:function(n,a){n&1&&(r(0,"div",0)(1,"div",1)(2,"button",2),x("click",function(){return a.goBack()}),g(3,"lucide-icon",3),r(4,"span",4),o(5),d(6,"translate"),t()(),h(7,le,2,0,"div",5)(8,ue,72,50,"div",6),t()()),n&2&&(i(3),s("img",a.icons.ArrowLeft),i(2),b(c(6,4,"CHALLENGE.BACK")),i(2),s("ngIf",a.isLoading),i(),s("ngIf",!a.isLoading))},dependencies:[T,D,M,ee,K,j,W,Y,Q,te,Z,X,k,z,$,ie,A],styles:[".custom-dropdown[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:1px solid #d1d5db;border-radius:.5rem;text-align:left;background-color:#fff;display:flex;align-items:center;justify-content:space-between;outline:none;transition:all}.custom-dropdown[_ngcontent-%COMP%]:hover{border-color:#9ca3af}.custom-dropdown[_ngcontent-%COMP%]:focus{border-color:#000}.dropdown-menu[_ngcontent-%COMP%]{position:absolute;z-index:10;margin-top:.25rem;width:100%;background-color:#fff;border:1px solid #e5e7eb;border-radius:.5rem;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;max-height:15rem;overflow:auto}.dropdown-item[_ngcontent-%COMP%]{padding:.75rem 1rem;color:#111827;cursor:pointer;transition:color}.dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.rotate-180[_ngcontent-%COMP%]{transform:rotate(180deg)}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{border-color:#000;outline:none;box-shadow:none!important}input[type=date][_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{cursor:pointer}.skills-dropdown-container[_ngcontent-%COMP%]{max-height:250px;overflow-y:auto;z-index:50;position:absolute;width:100%;background:#fff;border:1px solid #e5e7eb;border-radius:.5rem;box-shadow:0 10px 15px -3px #0000001a}.skills-dropdown-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.skills-dropdown-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#d1d5db;border-radius:10px}"]})}};export{ne as EditChallenge};
